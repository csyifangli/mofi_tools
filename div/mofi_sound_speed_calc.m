function C = mofi_sound_speed_calc (T)
%
% C = mofi_sound_speed_calc (T)
%
% T: Water temperature in celcius
% C: Sound speed in meters per second
%
% By MOFI, from September 2011, last changed January 2012.
% 2013-09-17, Renamed to mofi_sound_speed_calc.
%
    
    a = zeros(6,3);
    M = zeros(3,1);
    P = 0.1013; %[MPa] = 1013hPa

    a(1,1) = 1402.38744;
    a(2,1) =  5.03836171;
    a(3,1) = -5.81172916  .* 1e-2;
    a(4,1) =  3.34638117  .* 1e-4;
    a(5,1) = -1.48259672  .* 1e-6;
    a(6,1) =  3.16585020  .* 1e-9;
    a(1,2) =  1.49043589;
    a(2,2) =  1.077850609 .* 1e-2;
    a(3,2) = -2.232794656 .* 1e-4;
    a(4,2) =  2.718246452 .* 1e-6;
    a(1,3) =  4.31532833  .* 1e-3;
    a(2,3) = -2.938590293 .* 1e-4;
    a(3,3) =  6.822485943 .* 1e-6;
    a(4,3) = -6.674551162 .* 1e-8;
    a(1,4) = -1.852993525 .* 1e-5;
    a(2,4) =  1.481844713 .* 1e-6;
    a(3,4) = -3.940994021 .* 1e-8;
    a(4,4) =  3.939902307 .* 1e-10;


    M = zeros(3,length(T));
    c0     = a(1,1) + a(2,1).*T + a(3,1).*T.^2 + a(4,1).*T.^3 + a(5,1).*T.^4 + a(6,1).*T.^5;
    M(1,:) = a(1,2) + a(2,2).*T + a(3,2).*T.^2 + a(4,2).*T.^3;
    M(2,:) = a(1,3) + a(2,3).*T + a(3,3).*T.^2 + a(4,3).*T.^3;
    M(3,:) = a(1,4) + a(2,4).*T + a(3,4).*T.^2 + a(4,4).*T.^3;
    C      = c0     + M(1) .* (P - 0.101325) + M(2) .* (P - 0.101325)^2 + M(3) .* (P - 0.101325)^3;

    
